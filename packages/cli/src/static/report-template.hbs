<html>

<head>
  <meta charset="utf-8">
  <title>{{reportTitles.plotTitle}}</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {{!-- CHART-BOOTSTRAP.CSS --}}
  {{!-- TB-BOOTSTRAP.CSS --}}
</head>

<body>
  <div class="container">
    <header>
      <div class="title">
        <h1>Boxplot & Frequency Results</h1>
        <p class="mb-0">{{reportTitles.plotTitle}} on {{reportTitles.browserVersion}}</p>
      </div>
      <div>
        <img class="logo"/>
      </div>
    </header>
    {{>phaseDetailSection analysisForPhase=durationSection}}
    <div class="row">
      <div class="col">
        <h3>Cumulative sub-phases of duration</h3>
        <p>The chart below shows the finish times (a point in the page load duration) of the sub-phases for experiment
          and control. It gives a high level view on what changed (if any).</p>
        <p>You can view more details about the sub-phases in the section below "Isolated sub-phases of duration".</p>
      </div>
    </div>
    <div class="row">
      <div class="col">
          {{#each cumulativeCharts as |cumulativeChart|}}
          <div style="width: 1080px; height: 320px;">
              <canvas id="cumulative-{{cumulativeChart.unit}}-chart"></canvas>
          </div>
          {{/each}}
      </div>
    </div>

    <div class="page-break"></div>
    <div class="row">
      <div class="col">
        <h1 class="isolated">Isolated sub-phases of duration</h1>
        <hr>
      </div>
    </div>

    {{#each subPhaseSections as |analysisForPhase|}}
    {{>phaseDetailSection analysisForPhase=analysisForPhase}}
    {{/each}}
    <div class="page-break"></div>
    <div class="row">
      <div class="col">
        <h1>Resources</h1>
        <ul>
          <li><a href="https://www.tracerbench.com/docs/guide/stats-primer" target="_blank">Stats Primer</a>
          </li>
          <li><a href="https://towardsdatascience.com/understanding-boxplots-5e2df7bcbd51" target="_blank">Understanding
              Boxplots</a></li>
          <li><a href="https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test" target="_blank">Wilcoxon Rank-Sum
              Test</a></li>
        </ul>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <hr>
        <h1>Configs Used</h1>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <pre class="">
        {{configsSJSONString}}
      </pre>
      </div>
    </div>

  </div>
  {{!-- TRACERBENCH-CHART-JS --}}
  {{>phaseChartJSSection analysisForPhase=durationSection}}

  {{#each subPhaseSections as |analysisForPhase|}}
  {{>phaseChartJSSection analysisForPhase=analysisForPhase}}
  {{/each}}

  <script>
    const createChart = (unit, experimentData, controlData, labels) => {
    new Chart(document.getElementById(`cumulative-${unit}-chart`).getContext("2d"), {
      type: 'boxplot',
      data: {
        labels,
        datasets: [
          {
            label: '{{reportTitles.servers.[0].name}}',
            borderColor: '#0A2D46',
            backgroundColor: 'rgba(199, 241, 106, 0.50)',
            borderWidth: 1,
            itemBackgroundColor: '#1884E4',
            data: controlData
          },{
            label: '{{reportTitles.servers.[1].name}}',
            borderColor: '#0A2D46',
            backgroundColor: 'rgba(56, 210, 211, 0.50)',
            borderWidth: 1,
            itemBackgroundColor: '#1884E4',
            data: experimentData
          }
        ]
      },
      options: {
        aspectRatio: 3.375,
        devicePixelRatio: 2.5,
        legend: {
          position: 'top',
        },
        title: {
          display: false,
          text: 'Sub Phases of Duration (when they finished happening in the timeline)'
        },
        scales: {
          yAxes: [{
            ticks: {
              callback: function (value) {
                return [`${value} ${unit}`];
              }
            }
          }]
        }
      }
    });
    }
  {{#each cumulativeCharts as |cumulativeData|}}
    createChart(
      '{{cumulativeData.unit}}',
      {{{stringify cumulativeData.experimentData}}},
      {{{stringify cumulativeData.controlData}}},
      {{{stringify cumulativeData.categories}}},
    );
  {{/each}}
  </script>
</body>

</html>
